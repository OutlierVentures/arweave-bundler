var Ze=Object.defineProperty;var He=(e,t)=>{for(var s in t)Ze(e,s,{get:t[s],enumerable:!0})};import Ve from"node:module";var C={};He(C,{default:()=>E,getSource:()=>kt,globalPreload:()=>ut,initialize:()=>dt,load:()=>ce,resolve:()=>gt});import et from"node:fs/promises";import te from"node:module";import tt from"process";var Je=(e,t)=>new Error(`invalid moduleId: "${e}" (used by ${t})`),Qe=(e,t)=>new Error(`un-mocked moduleId: "${e}" (used by ${t})`),Xe=()=>new Error("For versions of node prior to v20.6.0, the loader chain process must include esmock. start the process using --loader=esmock."),Ye=(e,t)=>new Error(`no mocks provided for module: "${e}" (used by ${t})`),f={errModuleIdNotFound:Je,errModuleIdNotMocked:Qe,errMissingLoader:Xe,errModuleIdNoDefs:Ye};var[Z,st]=tt.versions.node.split(".").map(e=>+e),se=Z<16||Z===16&&st<12,g=import.meta.url,ot=/\?esmkgdefs=.*/,oe=/.*\?esmkgdefs=/,O=/#-#esmkdefs/,H=/^file:\/\/\/import\?/,rt=/file:\/\/\/import\?([^#]*)/,nt=/\bimport,|,import\b|\bimport\b/g,x=/esmkTreeId=\d*/,ct=/esmkModuleId=([^&]*)/,J=/\?esmk=\d*/,I=/.*exportNames=(.*)/,it=/.*#-#/,at=/isesm=true/,lt=/isfound=false/,pt=/^(commonjs|module)$/,mt=/strict=3/,Q=/^(#![^\n]*\n)/,X=(e,t)=>new RegExp(`.*(${e}(\\?${t}(?:(?!#-#).)*)).*`),S=global.mockKeys=global.mockKeys||{},ut=!te.register&&(({port:e})=>(e.addEventListener("message",t=>S[t.data.key]=t.data.keylong),e.unref(),"global.postMessageEsmk = d => port.postMessage(d)")),dt=te.register&&(e=>{e&&e.port&&e.port.on("message",t=>{S[t.key]=t.keylong})}),Y=e=>{let[t,s]=e.match(rt)||[];return[t,I.test(s)&&s.replace(I,"$1").split(",")]},ft=e=>{let t=e.split(O)[1]||"",s=Y(t),o=e.replace(oe,""),r=Y(o);return[s[0]||r[0],[...new Set([s[1]||[],r[1]||[]].flat())]]},re=e=>J.test(e)&&S[e.match(J)[0].split("=")[1]],ee=async(e,t,s)=>s.parentURL&&(s.conditions.slice(-1)[0]==="node-addons"||s.importAssertions||se)?e(t,s):e(t),gt=async(e,t,s)=>{let{parentURL:o}=t,r=re(o)||o;if(!x.test(r))return ee(s,e,t);let[n]=String(r).match(x),[c,l]=r.split(O),a=c&&c.replace(oe,"");if(r.includes(`esmkModuleId=${e}&isfound=false`)){let j=X(`file:///${e}`,n),b=(a.match(j)||l.match(j)||[])[2];if(b)return{shortCircuit:!0,url:g+b}}if(H.test(e))return{shortCircuit:!0,url:e.replace(H,g+"?")};let p=await ee(s,e,t),u=X(p.url,n),d=u.test(l)&&l.replace(u,"$1")||u.test(a)&&a.replace(u,"$1");if(d?p.url=at.test(d)?d:g+"#-#"+d:a&&a!=="0"&&(p.url.startsWith("node:")||(p.url+="?esmkgdefs="+a)),mt.test(r)&&!d)throw f.errModuleIdNotMocked(p.url,r.split("?")[0]);return p},ne=g+"?esmock-loader=true",E=(e=>async()=>e=e||(await import(ne)).default===!0)(),ce=async(e,t,s)=>{if(e===ne)return{format:"module",shortCircuit:!0,responseURL:e,source:"export default true"};let o=re(e)||e;if(o&&(o.match(x)||[])[0]){let[c,l]=ft(o);if(l&&l.length){let a=await s(e,t);if(!pt.test(a.format))return a;let p=a.source===null||a.source===void 0,u=String(p?await et.readFile(new URL(e)):a.source),d=(u.match(Q)||[])[0]||"",j=d?u.replace(Q,""):u,b=a.format==="commonjs"?`const {${l}} = global.esmockCacheGet("${c}");`:`import {${l}} from '${c}';`;return{format:a.format,shortCircuit:!0,responseURL:encodeURI(e),source:d+b+j}}}if(O.test(e))return s(e,t);e=e.replace(ot,""),e.startsWith(g)&&(e=e.replace(it,""),lt.test(e)&&(e=e.replace(g,`file:///${e.match(ct)[1]}`)));let n=I.test(e)&&e.replace(I,"$1").replace(nt,"").split(",");return n&&n[0]?{format:"module",shortCircuit:!0,responseURL:encodeURI(e),source:n.map(c=>c==="default"?`export default global.esmockCacheGet("${e}").default`:`export const ${c} = global.esmockCacheGet("${e}").${c}`).join(`
`)}:s(e,t)},kt=se&&ce;import Lt from"fs";import ue from"fs";import de from"url";import i from"path";import fe from"module";var ge=fe.createRequire(import.meta.url),ie=ue.realpathSync.native,ke=new RegExp("^(?:node:)?("+fe.builtinModules.join("|").replace("/","/")+")$"),he=/^\.?\.?([a-zA-Z]:)?(\/|\\)/,D=/^.\.?(?=\/|\\)/,ae=/\\/g,ht=/index.[tj]sx?$/,yt=/[\\/]resolvewithplus[\\/]/,le=/\.js$/,jt=/\.ts$/,bt=/(^@[^/]*\/[^/]*|^[^/]*)\/?(.*)$/,F=/^#/,ye=/(\*)/g,je=/([./])/g,It=/^node:/,Mt=/^file:/,be=[".js",".mjs",".ts",".tsx",".json",".node"],wt=be.map(e=>`index${e}`),pe="node_modules",w="package.json",Ie="node",M="default",$t="browser",Me="import",N=":spectype",we="module",$e="import",Re="commonjs",Rt="require",v=".",xt=e=>e&&typeof e=="object",T={},A=e=>({[we]:$e,[Re]:Rt})[e]||null,Ot=e=>It.test(e)?e:`node:${e}`,St=e=>e&&de.pathToFileURL(e).href,Et=e=>ke.test(e),Ct=e=>Mt.test(e)?de.fileURLToPath(e):e,vt=e=>i.resolve(i.extname(e)?i.dirname(e):e)+i.sep,K=e=>ae.test(e)?e.replace(ae,i.posix.sep):e,k=(e,t)=>{try{t=ue.statSync(e)}catch{t=!1}return t&&(t.isFile()||t.isFIFO())},xe=(e,t)=>t.packagejsonmap&&t.packagejsonmap[e]||k(e)&&ge(e),Pt=(e,t)=>{let s=t.find(o=>k(e+o))||null;return s&&e+s},Ft=(e,t)=>{let s=t.find(o=>k(i.join(e,o)))||null;return s&&i.join(e,s)},Oe=(e,t=e.split(i.sep))=>{let s=(o,r=[[],[]])=>{if(!o.length)return r[1];if(o[0]===pe&&yt.test(e))return s(o.slice(1),r);let n=r[0].length?i.join(r[0].slice(-1)[0],o[0]):o[0]||i.sep;return r[0].push(n),r[1].push(i.resolve(i.join(n,pe))),s(o.slice(1),r)};return s(t)},Nt=e=>{let t=e.split(i.sep).slice(1).reduce((s,o,r)=>(s.push(i.resolve(i.join(r?s[r-1]:i.sep,o))),s),[]).reverse().find(s=>k(i.join(s,w)));return t&&i.join(t,w)},Tt=e=>(String(e).match(bt)||[]).slice(1),me=(e,t)=>new RegExp(e.replace(je,"\\$1").replace(ye,".*")).test(t),At=(e,t,s)=>{let o=new RegExp(e.replace(je,"\\$1").replace(ye,"(.*)")),r=(s.match(o)||[])[1];return r&&t.replace("*",r)},Se=(e,t,s,o=!1)=>(me(e,s)&&(t.includes("*")?me(t,s)?o=s:e.includes("*")&&e!==t&&(o=At(e,t,s)):o=t),o),Ee=(e,t,s,o=e[0])=>e.length?(F.test(s)?F.test(o):D.test(o))&&typeof t[o]=="string"&&Se(o,t[o],s)||Ee(e.slice(1),t,s):null,m=(e,t,s={})=>{let o=s.priority||[Ie,M],r=!1;return typeof e=="string"?e:(!r&&Array.isArray(e)&&(r=e.reduce((n,c)=>n||m(c,t,s),null)),!r&&xt(e)&&(typeof e[t]=="string"&&(r=e[t]),r||(r=o.reduce((n,c)=>n||(c=c===N?A(s.packagejsontype):c,m(e[c],t,s)),!1)),!r&&e[M]&&(r=m(e[M],t)),!r&&e[t]&&(r=m(e[t],t,s)),r||(r=Ee(Object.keys(e),e,t)),!r&&e[v]&&(o.includes(t)?r=o.reduce((n,c)=>n||(c=c===N?A(s.packagejsontype):c,m(e[v],c,s)),!1):r=m(e[v],t,s))),r)},$=(e,t={})=>{var s=null,o=t.istypescript&&le.test(e)&&e.replace(le,".ts");return k(o)?s=o:k(e)?s=e:s=Pt(e,be),s},G=e=>e.type||"exports"in e&&we||Re,P=(e,t={},s="")=>{let o=s?i.join(s,e):e;return $(o,t)||!ht.test(e)&&$(i.join(o,"index"))},Kt=(e,t={},s="",o=!1)=>{let r=G(e);return t.isspectype!==!1&&(o=e[r]||e[A(r)],o=o&&P(o,t,s)),!o&&(t.priority||[]).includes($e)&&e.module&&(o=P(e.module,t,s)),!o&&e.main&&(o=P(e.main,t,s)),o||null},Ce=(e,t={},s="",o)=>{let r=G(e),n=Object.assign({packagejsontype:r},t);return t.isbrowser&&e.browser&&(o=m(e.browser,Me,n),o=o&&!he.test(o)?i.join(s,o):o),o||(o=Kt(e,n,s)),o},ve=(e,t)=>{let s=i.join(e,w),o=xe(s,t);return(o?Ce(o,t,e):!1)||Ft(e,wt)},Pe=(e,t,s)=>{let o=D.test(e)?i.join(t,e):e;return $(o,s)||ve(o,s)},Dt=(e,t,s,o)=>{let r=s&&s.imports,n=m(r,t,o);return n&&(D.test(n)?i.join(e,n):Ne(n,e,{isposixpath:!0}))},Gt=(e,t,s,o,r)=>{let n=m(o&&o.exports,s?"./"+s:Me,r);return n&&i.join(e,t,n)},Ut=(e,t,s,o)=>{let r=i.join(e,t,w),n=xe(r,o),c=n&&G(n);return n&&Gt(e,t,s,n,Object.assign({packagejsontype:c},o))},zt=(e,t,s)=>{let o=Nt(t),r=i.dirname(o);return o&&Dt(r,e,ge(o),s)},Bt=(e,t,s)=>{let[o,r]=Tt(e);if(F.test(o))return zt(e,t,s);let n=Oe(t);return function c(l,a){return a--?Ut(i.join(l[a]),o,r,s)||Pe(i.join(l[a],e),null,s)||c(n,a):null}(n,n.length)},_t=(e,t,s)=>{var o=null;return t=typeof t=="string"?vt(Ct(decodeURI(t))):process.cwd(),ke.test(e)?o=Ot(e):(o=he.test(e)?Pe(K(e),t,s):Bt(e,t,s),o=o&&(s.isposixpath?ie(o):St(K(ie(o))))),o},Fe=(e,t,s)=>{let o=(r,n)=>typeof r=="boolean"?r:n;return s=s||{},s.istypescript=o(s.istypescript,jt.test(t)),s.isbrowser=o(s.isbrowser,!1),s.isspectype=o(s.isspectype,!0),s.packagejsonmap=s.packagejsonmap||null,Array.isArray(s.priority)||(s.priority=s.isbrowser?[$t]:[],s.priority.push(N),s.priority.push(Ie),s.priority.push(M)),s},Ne=(e,t,s)=>{let o=T[e+t];return o||(s=Fe(e,t,s),o=_t(e,t,s),T[e+t]=o)},R=Object.assign(Ne,{pathToPosix:K,getasnode_module_paths:Oe,getesmkeyvalmatch:Se,getasfilesync:$,getasdirsync:ve,gettargetindex:Ce,iscoremodule:Et,createopts:Fe,esmparse:m,cache:T});var Te=/(^\s*|[});\n]\s*)(import\s+(['"]|(\*\s+as\s+)?[^"'()\n;]+\s+from\s+['"]|\{)|export\s+\*\s+from\s+["']|export\s+(\{|default|function|class|var|const|let|async\s+function))/;import Ae from"node:module";import Ke from"node:worker_threads";var U=Ke.MessageChannel&&new Ke.MessageChannel,De=(e=>()=>(typeof e=="boolean"||(e=!!Ae.register)&&Ae.register("./esmockLoader.js",{parentURL:import.meta.url,data:{port:U.port2},transferList:[U.port2]}),e))(),Ge=Object.assign(e=>{De()?U.port1.postMessage(e):typeof global.postMessageEsmk=="function"&&global.postMessageEsmk(e)},{register:De});var z={isESM:{},mockDefs:{}},Ue=(e,t)=>(Ge({key:e,keylong:t}),global.mockKeys[String(e)]=t),B=e=>global.mockKeys[String(e)],_=(e,t)=>global.esmockCache.mockDefs[e]=t,qt=e=>global.esmockCache.mockDefs[e],ze=e=>z.isESM[e],Be=(e,t)=>z.isESM[e]=t;Object.assign(global,{esmockCache:z,esmockCacheGet:qt,esmockTreeIdGet:B,mockKeys:global.mockKeys||{}});var q=e=>typeof e=="object"&&e,L=e=>q(e)&&"default"in e,Wt=/^\.?\.?([a-zA-Z]:)?(\/|\\)/,Vt=((e=0)=>()=>++e)(),Zt=Object.getPrototypeOf({}),Ht=e=>Object.getPrototypeOf(e)===Zt,_e=R.iscoremodule,Jt=(e,t)=>Ht(e)?Object.assign({},e,t):Object.assign(Object.keys(e).reduce((s,o)=>(Object.defineProperty(s,o,{value:e[o],writable:!0}),s),Object.create(e)),t),Qt=(e,t)=>q(e)&&q(t)?Jt(e,t):t,Xt=(e,t,s)=>s===null?Object.assign({},e||{},t):(t=Object.assign({},e||{},{default:Qt(L(e)&&e.default,L(t)?t.default:t)},t),!_e(s)&&Object.isExtensible(t.default)&&(t.default.default=t.default),t),Yt=(e,t)=>(t=ze(e),typeof t=="boolean"||(t=!_e(e)&&Wt.test(e)&&Te.test(Lt.readFileSync(e,"utf-8")),Be(e,t)),t),es=(e,t)=>{let s=L(e)&&e.default;return/boolean|string|number/.test(typeof s)?e:Object.isExtensible(s)?Object.assign(s,e,{esmkTreeId:t}):Object.assign({},s,e,{esmkTreeId:t})},ts=e=>{let t=n=>n==="null"||_(n,null),s=B(e.split("esmk=")[1]),[o,r]=s.split("#-#esmkdefs=");String(r).split("#-#").forEach(t),String(o.split("esmkgdefs=")[1]).split("#-#").forEach(t)},ss=async(e,t,s,o,r)=>{t=Xt(r.strict||!o||await import(o),t,o);let n=(o||"file:///"+s)+"?"+["esmkTreeId="+e,"esmkModuleId="+s,"isfound="+!!o,"isesm="+Yt(o),"exportNames="+Object.keys(t).sort().join()].join("&");return _(n,t),n},W=async(e,t,s,o,r,n,c)=>{if(o=o||Object.keys(s),c=o[0],n=n||[],!c)return n;let l=r.resolver(c,e);if(!l&&r.isModuleNotFoundError!==!1&&c!=="import")throw f.errModuleIdNotFound(c,e);return n.push(await ss(t,s[c],c,l,r)),W(e,t,s,o.slice(1),r,n)},os=async(e,t,s,o,r)=>{let n=r.resolver(e,t);if(!n)throw f.errModuleIdNotFound(e,t);let c=o?Object.keys(o):[],l=s?Object.keys(s):[];if(r.strict===3&&!c.length&&!l.length)throw f.errModuleIdNoDefs(e,t);let a=typeof r.id=="number"?r.id:Vt(),p=`${n}?key=${a}&strict=${r.strict}?`+["esmkgdefs="+(c.length&&(await W(t,a,o,c,r)).join("#-#")||0),"esmkdefs=",l.length&&(await W(t,a,s,l,r)).join("#-#")||0].join("#-#");return Ue(String(a),p),n+`?esmk=${a}`},y=Object.assign(os,{purge:ts,sanitize:es});import{isBuiltin as rs}from"node:module";import{pathToFileURL as ns}from"node:url";var qe=process.versions.pnp&&(await import("pnpapi")).default,Le=qe&&((e,t)=>{if(rs(e))return e.startsWith("node:")?e:`node:${e}`;if(e==="import")return null;let s=null;try{s=qe.resolveRequest(e,t)}catch{}return s!==null?ns(s).href:null});var cs=/^.*(\(|at )(.*):[\d]*:[\d]*.*$/,is=Le||R,We=(e,t)=>(e=typeof e[1]=="string"?e:[e[0],new Error().stack.split(`
`)[3].replace(cs,"$2"),...e.slice(1)],e[4]={resolver:is,...e[4],...t},e);var h=e=>async(...t)=>{let[s,o,r,n,c]=We(t,e);if(!Ve.register&&!await E())throw f.errMissingLoader();let l=await y(s,o,r,n,c),a=await import(l);return c.purge!==!1&&y.purge(l),y.sanitize(a,l)},V=e=>e&&/object|function/.test(typeof e)&&"esmkTreeId"in e&&y.purge(e.esmkTreeId),as=Object.assign(h({strict:1}),{purge:V,p:h({strict:1,purge:!1})}),ls=Object.assign(h({strict:3}),{purge:V,p:h({strict:3,purge:!1})}),Ls=Object.assign(h(),{purge:V,p:h({purge:!1}),strict:as,strictest:ls});var ps=Ve.register?{}:C,{load:Ws,resolve:Vs,getSource:Zs,initialize:Hs,globalPreload:Js}=ps;export{Ls as default,Zs as getSource,Js as globalPreload,Hs as initialize,Ws as load,Vs as resolve,as as strict,ls as strictest};
